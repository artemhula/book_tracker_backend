generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id           String    @id(map: "users_pkey") @default(uuid()) @db.Uuid
  email        String    @unique(map: "users_email_key") @db.VarChar(255)
  fullName     String?   @map("full_name") @db.VarChar(255)
  avatarUrl    String?   @map("avatar_url")
  createdAt    DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  refreshToken String?   @map("refresh_token")
  book         book[]
  record       record[]

  @@map("users")
}

model book {
  id          String   @id(map: "books_pkey") @default(uuid()) @db.Uuid
  userId      String   @map("user_id") @db.Uuid
  isbn        String
  title       String
  author      String?
  totalPages  Int?     @map("total_pages")
  currentPage Int?     @map("current_page")
  coverUrl    String?  @map("cover_url")
  user        user     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "books_user_id_fkey")
  record      record[]

  @@map("books")
}

model record {
  id        String    @id(map: "records_pkey") @default(uuid()) @db.Uuid
  bookId    String    @map("book_id") @db.Uuid
  userId    String    @map("user_id") @db.Uuid
  pagesRead Int       @map("pages_read")
  readAt    DateTime? @default(now()) @map("read_at") @db.Timestamptz
  book      book      @relation(fields: [bookId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "records_book_id_fkey")
  user      user      @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "records_user_id_fkey")

  @@map("records")
}
